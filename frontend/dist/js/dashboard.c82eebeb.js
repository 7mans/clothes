(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dashboard"],{"0d26":function(t,e,r){"use strict";var n=r("e330"),a=Error,s=n("".replace),o=function(t){return String(new a(t).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,c=i.test(o);t.exports=function(t,e){if(c&&"string"==typeof t&&!a.prepareStackTrace)while(e--)t=s(t,i,"");return t}},1787:function(t,e,r){"use strict";var n=r("861d");t.exports=function(t){return n(t)||null===t}},"17e8":function(t,e,r){},"271a":function(t,e,r){"use strict";var n=r("cb2d"),a=r("e330"),s=r("577e"),o=r("d6d6"),i=URLSearchParams,c=i.prototype,u=a(c.getAll),l=a(c.has),d=new i("a=1");!d.has("a",2)&&d.has("a",void 0)||n(c,"has",(function(t){var e=arguments.length,r=e<2?void 0:arguments[1];if(e&&void 0===r)return l(this,t);var n=u(this,t);o(e,1);var a=s(r),i=0;while(i<n.length)if(n[i++]===a)return!0;return!1}),{enumerable:!0,unsafe:!0})},"2ba4":function(t,e,r){"use strict";var n=r("40d5"),a=Function.prototype,s=a.apply,o=a.call;t.exports="object"==typeof Reflect&&Reflect.apply||(n?o.bind(s):function(){return o.apply(s,arguments)})},"2baa":function(t,e,r){"use strict";t.exports=function(t,e){var r="function"==typeof Iterator&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch(n){return!0}}},"2d93":function(t,e,r){"use strict";r("17e8")},"3b8a":function(t,e,r){},"3bbe":function(t,e,r){"use strict";var n=r("1787"),a=String,s=TypeError;t.exports=function(t){if(n(t))return t;throw new s("Can't set "+a(t)+" as a prototype")}},4754:function(t,e,r){"use strict";t.exports=function(t,e){return{value:t,done:e}}},"4e0a":function(t,e,r){"use strict";r("689d")},5494:function(t,e,r){"use strict";var n=r("83ab"),a=r("e330"),s=r("edd0"),o=URLSearchParams.prototype,i=a(o.forEach);n&&!("size"in o)&&s(o,"size",{get:function(){var t=0;return i(this,(function(){t++})),t},configurable:!0,enumerable:!0})},"577e":function(t,e,r){"use strict";var n=r("f5df"),a=String;t.exports=function(t){if("Symbol"===n(t))throw new TypeError("Cannot convert a Symbol value to a string");return a(t)}},"689d":function(t,e,r){},6964:function(t,e,r){"use strict";var n=r("cb2d");t.exports=function(t,e,r){for(var a in e)n(t,a,e[a],r);return t}},"6f19":function(t,e,r){"use strict";var n=r("9112"),a=r("0d26"),s=r("b980"),o=Error.captureStackTrace;t.exports=function(t,e,r,i){s&&(o?o(t,e):n(t,"stack",a(r,i)))}},7156:function(t,e,r){"use strict";var n=r("1626"),a=r("861d"),s=r("d2bb");t.exports=function(t,e,r){var o,i;return s&&n(o=e.constructor)&&o!==r&&a(i=o.prototype)&&i!==r.prototype&&s(t,i),t}},7277:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"dashboard-page container"},[t._m(0),e("div",{staticClass:"custom-row"},[e("div",{staticClass:"custom-col upload-col"},[e("div",{staticClass:"upload-section card"},[e("h3",[t._v("开始属于你的分析")]),e("ImageUploader",{on:{"upload-success":t.onUploadSuccess}})],1)]),e("div",{staticClass:"custom-col result-col"},[e("div",{staticClass:"analysis-result-section card"},[e("h3",[t._v("AI分析结果")]),e("AnalysisResult",{attrs:{"analysis-data":t.currentAnalysis}})],1)])])])},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-header"},[e("h1",[t._v("我的主页")]),e("p",[t._v("在这里开始你的时尚之旅，上传图片，发现新的时尚灵感。")])])}],s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"image-uploader"},[e("div",{staticClass:"uploader"},[e("div",{staticClass:"upload-area",class:{disabled:t.loading,"drag-over":t.dragOver},on:{dragover:function(t){t.preventDefault()},dragenter:[function(t){t.preventDefault()},function(e){t.dragOver=!0}],drop:function(e){return e.preventDefault(),t.handleDrop.apply(null,arguments)},click:t.triggerFileInput,dragleave:function(e){t.dragOver=!1}}},[e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*",disabled:t.loading},on:{change:t.handleFileInput}}),t.imageUrl?e("div",{staticClass:"image-preview"},[e("img",{staticClass:"preview-image",attrs:{src:t.imageUrl}}),e("div",{staticClass:"re-upload-mask"},[t._v("重新上传")])]):e("div",{staticClass:"upload-placeholder"},[e("span",{staticClass:"upload-icon"},[t._v("📤")]),t._m(0),e("div",{staticClass:"upload-tip"},[t._v("支持 JPG/PNG/GIF/WEBP 格式，大小不超过10MB")])]),t.loading?e("div",{staticClass:"upload-loading"},[e("div",{staticClass:"loading-spinner"}),e("p",[t._v("分析中...")])]):t._e()])])])},o=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"upload-text"},[t._v("将图片拖到此处，或"),e("em",[t._v("点击上传")])])}],i=(r("d9e2"),r("14d9"),r("e9f5"),r("7d54"),r("ab43"),r("88a7"),r("271a"),r("5494"),{name:"ImageUploader",data(){return{loading:!1,imageUrl:null,dragOver:!1}},methods:{triggerFileInput(){this.loading||this.$refs.fileInput.click()},handleFileInput(t){const e=t.target.files[0];e&&this.handleFile(e)},handleDrop(t){this.dragOver=!1;const e=t.dataTransfer.files;e.length>0&&this.handleFile(e[0])},async handleFile(t){if(this.validateFile(t)){this.loading=!0,this.imageUrl=URL.createObjectURL(t);try{await this.analyzeImage(t)}catch(e){this.handleError(e)}}},validateFile(t){const e=t.type.startsWith("image/"),r=t.size/1024/1024<10;return e?!!r||(this.showMessage("上传图片大小不能超过 10MB！","error"),!1):(this.showMessage("只能上传图片文件！","error"),!1)},showMessage(t,e="info"){const r=document.createElement("div");r.className="custom-message custom-message-"+e,r.textContent=t,Object.assign(r.style,{position:"fixed",top:"20px",left:"50%",transform:"translateX(-50%)",padding:"12px 20px",borderRadius:"6px",color:"white",fontSize:"14px",zIndex:"9999",transition:"all 0.3s ease"}),r.style.backgroundColor="error"===e?"#F56C6C":"success"===e?"#67C23A":"#409EFF",document.body.appendChild(r),setTimeout(()=>{r.style.opacity="0",setTimeout(()=>{document.body.removeChild(r)},300)},3e3)},async analyzeImage(t){console.log("开始分析图片:",{fileName:t.name,fileSize:t.size,fileType:t.type});try{const e=await this.fileToBase64(t),r=await this.callAIModel(e);console.log("分析成功:",r),this.handleSuccess({analysis:r})}catch(e){throw console.error("分析失败详情:",{message:e.message}),e}},async fileToBase64(t){return new Promise((e,r)=>{const n=new FileReader;n.onload=()=>e(n.result),n.onerror=r,n.readAsDataURL(t)})},async callAIModel(t){const e="161ec8aa-2cb6-4c30-add2-e34ec5e0a94b",r="https://ark.cn-beijing.volces.com/api/v3",n="doubao-1-5-thinking-vision-pro-250428",a='请严格按以下结构化格式（使用中文）分析图片并输出：\n\n【服装分析】\n- 整体概述：2-3句描述风格/氛围\n- 单品清单：逐条列出"明确名称：版型，材质/纹理，主色，图案，季节"，避免泛化如"上衣/裤子"，应写"白色直筒牛仔裤/米色羊毛西装外套"等\n- 场景识别：是否为"酒吧/咖啡厅/街头/海边/室内办公/校园"等\n- 场景即时建议：在不改动主体服装的前提下，追加2-3条"配饰/层次/鞋履/外搭"的优化建议。\n\n【穿搭建议】\n- 人物特征：性别特征、年龄感、体型轮廓、气质、肤色倾向\n- 分场景推荐（只推荐3个：日常办公/约会/商务会议/朋友聚会/颁奖典礼/逛街购物/海滩度假/旅行/婚礼等任意3个）：\n  1) 服装组合（上装/下装/外套/鞋履），明确"名称+颜色+关键版型"\n  2) 相配首饰、帽子与配件（2-3项）\n  3) 适用理由与风格效果（1-2句）\n- 配色与层次：整体配色方案与层次结构\n\n[结构化数组输出]\n- CLOTHES_IN_IMAGE=["白色直筒牛仔裤","米色羊毛西装外套",...]\n- OUTFIT_SCENES={\n  "通勤":["米色羊毛西装外套","白色真丝衬衫","灰色西装裤","黑色乐福鞋"],\n  "约会":[...],\n  "度假":[...]\n}\n注意：以上两项为机器可读，放在文末，除此之外不要再输出其他JSON。';try{const s=await fetch(r+"/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify({model:n,messages:[{role:"user",content:[{type:"image_url",image_url:{url:t}},{type:"text",text:a}]}]})});if(!s.ok)throw new Error("API调用失败: "+s.status);const o=await s.json(),i=o.choices[0].message.content;return this.extractAndLogArrays(i),{clothing_type:this.extractClothingType(i),style_tags:this.extractStyleTags(i),color_tags:this.extractColorTags(i),detailed_analysis:i,raw_response:i}}catch(s){throw console.error("AI模型调用失败:",s),new Error("AI分析失败: "+s.message)}},extractClothingType(t){return t.includes("上衣")||t.includes("T恤")||t.includes("衬衫")?"上衣":t.includes("裤子")||t.includes("牛仔裤")?"裤子":t.includes("裙子")||t.includes("连衣裙")?"裙装":"服装"},extractStyleTags(t){const e=[],r=["休闲","正式","运动","时尚","简约","复古","甜美","帅气","优雅","商务"];return r.forEach(r=>{t.includes(r)&&e.push(r)}),e.slice(0,5)},extractAndLogArrays(t){try{const e=t.match(/CLOTHES_IN_IMAGE\s*=\s*\[(.*?)\]/);if(e){const t=e[1].split(",").map(t=>t.trim().replace(/['"]/g,""));console.log("CLOTHES_IN_IMAGE:",t)}const r=t.match(/OUTFIT_SCENES\s*=\s*\{([\s\S]*?)\}/);if(r){const t=r[1],e={},n=t.match(/"([^"]+)"\s*:\s*\[(.*?)\]/g);n&&n.forEach(t=>{const r=t.match(/"([^"]+)"\s*:\s*\[(.*?)\]/);if(r){const t=r[1],n=r[2].split(",").map(t=>t.trim().replace(/['"]/g,""));e[t]=n}}),console.log("OUTFIT_SCENES:",e)}}catch(e){console.error("提取数组时出错:",e)}},extractColorTags(t){const e=[],r=["白色","黑色","蓝色","红色","绿色","黄色","灰色","棕色","粉色","紫色"];return r.forEach(r=>{t.includes(r)&&e.push(r)}),e.slice(0,5)},handleSuccess(t){this.loading=!1,t&&t.analysis?(this.$emit("upload-success",t.analysis),this.showMessage("图片分析完成！","success")):this.handleError(new Error("分析响应格式不正确"))},handleError(t){this.loading=!1,this.imageUrl=null;let e="上传失败，请稍后重试";if(t.response){const r=t.response.status,n=t.response.data;switch(r){case 400:e=(null===n||void 0===n?void 0:n.detail)||(null===n||void 0===n?void 0:n.message)||"请求参数错误";break;case 401:e="未授权，请重新登录";break;case 413:e="文件过大";break;case 415:e="不支持的文件格式";break;case 500:e="服务器内部错误";break;default:e=`上传失败 (${r})`}}else"ECONNABORTED"===t.code&&(e="上传超时，请检查网络连接");this.showMessage(e,"error")}}}),c=i,u=(r("c2e3"),r("2877")),l=Object(u["a"])(c,s,o,!1,null,"51354cd4",null),d=l.exports,f=function(){var t=this,e=t._self._c;return e("div",{staticClass:"analysis-result"},[t.analysisData?e("div",{staticClass:"result-content"},[e("pre",[t._v(t._s(t.analysisData.detailed_analysis))])]):e("div",{staticClass:"placeholder"},[e("span",{staticClass:"promotion-icon"},[t._v("🎯")]),e("p",[t._v("上传图片后，AI分析结果将显示在这里")])])])},p=[],h={name:"AnalysisResult",props:{analysisData:{type:Object,default:null}}},v=h,g=(r("2d93"),Object(u["a"])(v,f,p,!1,null,"b7fb9346",null)),y=g.exports,m={name:"Dashboard",components:{ImageUploader:d,AnalysisResult:y},data(){return{currentAnalysis:null}},methods:{onUploadSuccess(t){this.showMessage("图片分析完成！","success"),this.currentAnalysis=t},showMessage(t,e="info"){const r=document.createElement("div");r.className="custom-message custom-message-"+e,r.textContent=t,Object.assign(r.style,{position:"fixed",top:"20px",left:"50%",transform:"translateX(-50%)",padding:"12px 20px",borderRadius:"6px",color:"white",fontSize:"14px",zIndex:"9999",transition:"all 0.3s ease"}),r.style.backgroundColor="error"===e?"#F56C6C":"success"===e?"#67C23A":"#409EFF",document.body.appendChild(r),setTimeout(()=>{r.style.opacity="0",setTimeout(()=>{document.body.removeChild(r)},300)},3e3)}}},b=m,x=(r("4e0a"),Object(u["a"])(b,n,a,!1,null,"c847ea58",null));e["default"]=x.exports},7282:function(t,e,r){"use strict";var n=r("e330"),a=r("59ed");t.exports=function(t,e,r){try{return n(a(Object.getOwnPropertyDescriptor(t,e)[r]))}catch(s){}}},"7d54":function(t,e,r){"use strict";var n=r("23e7"),a=r("c65b"),s=r("2266"),o=r("59ed"),i=r("825a"),c=r("46c4"),u=r("2a62"),l=r("f99f"),d=l("forEach",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:d},{forEach:function(t){i(this);try{o(t)}catch(n){u(this,"throw",n)}if(d)return a(d,this,t);var e=c(this),r=0;s(e,(function(e){t(e,r++)}),{IS_RECORD:!0})}})},"88a7":function(t,e,r){"use strict";var n=r("cb2d"),a=r("e330"),s=r("577e"),o=r("d6d6"),i=URLSearchParams,c=i.prototype,u=a(c.append),l=a(c["delete"]),d=a(c.forEach),f=a([].push),p=new i("a=1&a=2&b=3");p["delete"]("a",1),p["delete"]("b",void 0),p+""!=="a=2"&&n(c,"delete",(function(t){var e=arguments.length,r=e<2?void 0:arguments[1];if(e&&void 0===r)return l(this,t);var n=[];d(this,(function(t,e){f(n,{key:e,value:t})})),o(e,1);var a,i=s(t),c=s(r),p=0,h=0,v=!1,g=n.length;while(p<g)a=n[p++],v||a.key===i?(v=!0,l(this,a.key)):h++;while(h<g)a=n[h++],a.key===i&&a.value===c||u(this,a.key,a.value)}),{enumerable:!0,unsafe:!0})},"9bdd":function(t,e,r){"use strict";var n=r("825a"),a=r("2a62");t.exports=function(t,e,r,s){try{return s?e(n(r)[0],r[1]):e(r)}catch(o){a(t,"throw",o)}}},ab36:function(t,e,r){"use strict";var n=r("861d"),a=r("9112");t.exports=function(t,e){n(e)&&"cause"in e&&a(t,"cause",e.cause)}},ab43:function(t,e,r){"use strict";var n=r("23e7"),a=r("c65b"),s=r("59ed"),o=r("825a"),i=r("46c4"),c=r("c5cc"),u=r("9bdd"),l=r("2a62"),d=r("2baa"),f=r("f99f"),p=r("c430"),h=!p&&!d("map",(function(){})),v=!p&&!h&&f("map",TypeError),g=p||h||v,y=c((function(){var t=this.iterator,e=o(a(this.next,t)),r=this.done=!!e.done;if(!r)return u(t,this.mapper,[e.value,this.counter++],!0)}));n({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(t){o(this);try{s(t)}catch(e){l(this,"throw",e)}return v?a(v,this,t):new y(i(this),{mapper:t})}})},aeb0:function(t,e,r){"use strict";var n=r("9bf2").f;t.exports=function(t,e,r){r in t||n(t,r,{configurable:!0,get:function(){return e[r]},set:function(t){e[r]=t}})}},b64e:function(t,e,r){"use strict";var n=r("2a62");t.exports=function(t,e,r){for(var a=t.length-1;a>=0;a--)if(void 0!==t[a])try{r=n(t[a].iterator,e,r)}catch(s){e="throw",r=s}if("throw"===e)throw r;return r}},b980:function(t,e,r){"use strict";var n=r("d039"),a=r("5c6c");t.exports=!n((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",a(1,7)),7!==t.stack)}))},c2e3:function(t,e,r){"use strict";r("3b8a")},c5cc:function(t,e,r){"use strict";var n=r("c65b"),a=r("7c73"),s=r("9112"),o=r("6964"),i=r("b622"),c=r("69f3"),u=r("dc4a"),l=r("ae93").IteratorPrototype,d=r("4754"),f=r("2a62"),p=r("b64e"),h=i("toStringTag"),v="IteratorHelper",g="WrapForValidIterator",y="normal",m="throw",b=c.set,x=function(t){var e=c.getterFor(t?g:v);return o(a(l),{next:function(){var r=e(this);if(t)return r.nextHandler();if(r.done)return d(void 0,!0);try{var n=r.nextHandler();return r.returnHandlerResult?n:d(n,r.done)}catch(a){throw r.done=!0,a}},return:function(){var r=e(this),a=r.iterator;if(r.done=!0,t){var s=u(a,"return");return s?n(s,a):d(void 0,!0)}if(r.inner)try{f(r.inner.iterator,y)}catch(o){return f(a,m,o)}if(r.openIters)try{p(r.openIters,y)}catch(o){return f(a,m,o)}return a&&f(a,y),d(void 0,!0)}})},w=x(!0),_=x(!1);s(_,h,"Iterator Helper"),t.exports=function(t,e,r){var n=function(n,a){a?(a.iterator=n.iterator,a.next=n.next):a=n,a.type=e?g:v,a.returnHandlerResult=!!r,a.nextHandler=t,a.counter=0,a.done=!1,b(this,a)};return n.prototype=e?w:_,n}},d2bb:function(t,e,r){"use strict";var n=r("7282"),a=r("861d"),s=r("1d80"),o=r("3bbe");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{t=n(Object.prototype,"__proto__","set"),t(r,[]),e=r instanceof Array}catch(i){}return function(r,n){return s(r),o(n),a(r)?(e?t(r,n):r.__proto__=n,r):r}}():void 0)},d6d6:function(t,e,r){"use strict";var n=TypeError;t.exports=function(t,e){if(t<e)throw new n("Not enough arguments");return t}},d9e2:function(t,e,r){"use strict";var n=r("23e7"),a=r("cfe9"),s=r("2ba4"),o=r("e5cb"),i="WebAssembly",c=a[i],u=7!==new Error("e",{cause:7}).cause,l=function(t,e){var r={};r[t]=o(t,e,u),n({global:!0,constructor:!0,arity:1,forced:u},r)},d=function(t,e){if(c&&c[t]){var r={};r[t]=o(i+"."+t,e,u),n({target:i,stat:!0,constructor:!0,arity:1,forced:u},r)}};l("Error",(function(t){return function(e){return s(t,this,arguments)}})),l("EvalError",(function(t){return function(e){return s(t,this,arguments)}})),l("RangeError",(function(t){return function(e){return s(t,this,arguments)}})),l("ReferenceError",(function(t){return function(e){return s(t,this,arguments)}})),l("SyntaxError",(function(t){return function(e){return s(t,this,arguments)}})),l("TypeError",(function(t){return function(e){return s(t,this,arguments)}})),l("URIError",(function(t){return function(e){return s(t,this,arguments)}})),d("CompileError",(function(t){return function(e){return s(t,this,arguments)}})),d("LinkError",(function(t){return function(e){return s(t,this,arguments)}})),d("RuntimeError",(function(t){return function(e){return s(t,this,arguments)}}))},e391:function(t,e,r){"use strict";var n=r("577e");t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:n(t)}},e5cb:function(t,e,r){"use strict";var n=r("d066"),a=r("1a2d"),s=r("9112"),o=r("3a9b"),i=r("d2bb"),c=r("e893"),u=r("aeb0"),l=r("7156"),d=r("e391"),f=r("ab36"),p=r("6f19"),h=r("83ab"),v=r("c430");t.exports=function(t,e,r,g){var y="stackTraceLimit",m=g?2:1,b=t.split("."),x=b[b.length-1],w=n.apply(null,b);if(w){var _=w.prototype;if(!v&&a(_,"cause")&&delete _.cause,!r)return w;var E=n("Error"),C=e((function(t,e){var r=d(g?e:t,void 0),n=g?new w(t):new w;return void 0!==r&&s(n,"message",r),p(n,C,n.stack,2),this&&o(_,this)&&l(n,this,C),arguments.length>m&&f(n,arguments[m]),n}));if(C.prototype=_,"Error"!==x?i?i(C,E):c(C,E,{name:!0}):h&&y in w&&(u(C,w,y),u(C,w,"prepareStackTrace")),c(C,w),!v)try{_.name!==x&&s(_,"name",x),_.constructor=C}catch(I){}return C}}}}]);
//# sourceMappingURL=dashboard.c82eebeb.js.map